{% extends "base.html" %}
{% block title %}
Caixas - Loja
{% endblock title %}

{% block content %}

<div class="container-xxl mt-4">
  <!-- Store Details -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card bg-light border-0 shadow-sm p-3">
        <h4 class="text-primary mb-3"><i class="bx bx-store-alt"></i> Detalhes da Loja</h4>
        <p><strong>Nome da Loja:</strong> {{ loja.nome }}</p>
        <p><strong>Endereço:</strong> {{ loja.endereco }}</p>
        <p><strong>Contato:</strong> {{ loja.telefone }}</p>
      </div>
    </div>
  </div>

  <!-- Table for Vendas -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card border-0 shadow-sm p-3" style="background-color: rgba(0, 128, 0, 0.05);">
        <h4 class="text-success mb-3"><i class="bx bx-log-in-circle"></i> Vendas</h4>
        <div class="table-responsive" style="height: 300px; overflow-y: auto;">
          <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">Item</th>
                <th scope="col">Data Caixa</th>
                <th scope="col">Valor</th>
              </tr>
            </thead>
            <tbody>
              {% for vendas in vendas %}
              {% for venda in vendas %}
              <tr>
                <td>{{ venda }}</td>
                <td>{{ venda.caixa.data_abertura }} - {{ venda.caixa.data_fechamento|default:"Aberto" }}</td>
                <td>R$ {{ venda.pagamentos_valor_total_dinheiro }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="3" class="text-center">Nenhuma venda registrada</td>
              </tr>
              {% endfor %}
              {% endfor %}
            </tbody>
          </table>
        </div>
        <p class="mt-3"><strong>Total: R$ {{ total_venda }}</strong></p>
      </div>
    </div>
  </div>

  <!-- Table for entradas -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card border-0 shadow-sm p-3" style="background-color: rgba(0, 0, 255, 0.05);">
        <h4 class="text-primary mb-3"><i class="bx bx-log-in-circle"></i> Entradas</h4>
        <div class="table-responsive" style="height: 300px; overflow-y: auto;">
          <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">Data</th>
                <th scope="col">Motivo</th>
                <th scope="col">Valor</th>
              </tr>
            </thead>
            <tbody>
              {% for entradas in entradas %}
              {% for entrada in entradas %}
              <tr>
                <td>{{ entrada.criado_em }}</td>
                <td>{{ entrada.motivo }}</td>
                <td>R$ {{ entrada.valor }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="3" class="text-center">Nenhuma entrada registrada</td>
              </tr>
              {% endfor %}
              {% endfor %}
            </tbody>
          </table>
        </div>
        <p class="mt-3"><strong>Total: R$ {{ total_entrada }}</strong></p>
      </div>
    </div>

    <!-- Table for Saídas -->
    <div class="row mt-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm p-3" style="background-color: rgba(255, 0, 0, 0.05);">
          <h4 class="text-danger mb-3"><i class="bx bx-log-out-circle"></i> Entradas</h4>
          <!-- Table -->
          <div class="table-responsive" style="height: 300px; overflow-y: auto;">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Data</th>
                  <th scope="col">Motivo</th>
                  <th scope="col">Valor</th>
                </tr>
              </thead>
              <tbody>
                {% for saidas in saidas %}
                {% for saida in saidas %}
                <tr>
                  <td>{{ saida.criado_em }}</td>
                  <td>{{ saida.motivo }}</td>
                  <td>R$ {{ saida.valor }}</td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="3" class="text-center">Nenhuma saída registrada</td>
                </tr>
                {% endfor %}
                {% endfor %}
              </tbody>
            </table>
          </div>
          <p class="mt-3"><strong>Total: R$ {{ total_saida }}</strong></p>
        </div>
      </div>
    </div>

    <!-- Total -->
    <div class="row mt-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm p-3">
          <h4 class="text-primary mb-3"><i class="bx bx-dollar-circle"></i> Total</h4>
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">Descrição</th>
                  <th scope="col">Valor</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Vendas</td>
                  <td>R$ {{ total_venda }}</td>
                </tr>
                <tr>
                  <td>Entradas</td>
                  <td>R$ {{ total_entrada }}</td>
                </tr>
                <tr>
                  <td>Saídas</td>
                  <td>R$ {{ total_saida }}</td>
                </tr>
                <tr>
                  <td><strong>Total</strong></td>
                  <td><strong>R$ {{ total }}</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>

    {% endblock %}